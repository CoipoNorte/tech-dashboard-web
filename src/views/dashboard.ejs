<%- include('partials/header', { title }) %>
<%
function getTextColor(bgColor) {
  if (!bgColor) return "#000";
  var r = parseInt(bgColor.substr(1,2),16);
  var g = parseInt(bgColor.substr(3,2),16);
  var b = parseInt(bgColor.substr(5,2),16);
  var yiq = ((r*299)+(g*587)+(b*114))/1000;
  return (yiq >= 128) ? "#000" : "#fff";
}
%>
<div class="row mb-4">
  <div class="col-12">
    <h1 class="display-5 fw-bold mb-3"><i class="bi bi-speedometer2"></i> Dashboard</h1>
    <hr>
  </div>
</div>
<div class="row g-4">
  <div class="col-md-4">
    <div class="card shadow-sm border-0 text-bg-primary mb-3">
      <div class="card-body d-flex flex-column align-items-center">
        <i class="bi bi-people-fill" style="font-size:2.5rem;"></i>
        <h5 class="card-title mt-2">Clientes</h5>
        <p class="card-text fs-2 fw-bold"><%= totalClientes %></p>
      </div>
    </div>
  </div>
  <% estados.forEach(estado => { %>
    <div class="col-md-4">
      <div class="card shadow-sm border-0 mb-3" style="background-color: <%= estado.color %>;">
        <div class="card-body d-flex flex-column align-items-center" style="color: <%= getTextColor(estado.color) %>;">
          <i class="bi bi-clipboard-check" style="font-size:2.5rem;"></i>
          <h5 class="card-title mt-2"><%= estado.nombre %></h5>
          <p class="card-text fs-2 fw-bold"><%= trabajosPorEstado[estado.nombre] || 0 %></p>
        </div>
      </div>
    </div>
  <% }) %>
</div>
<%- include('partials/footer') %>