<%- include('../partials/header', { title }) %>
<h1>Clientes</h1>

<!-- Barra de búsqueda y botón nuevo cliente -->
<div class="row mb-3 align-items-center">
  <div class="col-12 col-md-6 col-lg-4 mb-2 mb-md-0">
    <form class="d-flex w-100" method="get">
      <input
        type="text"
        name="q"
        value="<%= q || '' %>"
        placeholder="Buscar cliente..."
        class="form-control flex-grow-1"
      >
      <button class="btn btn-outline-primary ms-2" type="submit">
        <i class="bi bi-search"></i>
      </button>
    </form>
  </div>
  <div class="col-12 col-md-6 col-lg-8 text-start text-md-end">
    <a href="/clientes/nuevo" class="btn btn-success">
      <i class="bi bi-plus-circle me-1"></i> Nuevo Cliente
    </a>
  </div>
</div>

<!-- Tabla responsiva en escritorio -->
<div class="d-none d-lg-block">
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Teléfono</th>
          <th>Email</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <% clientes.forEach(cliente => { %>
          <tr>
            <td>
              <a href="/clientes/<%= cliente._id %>" class="fw-bold text-dark text-decoration-none enlace-lupa">
                <i class="bi bi-search"></i> <%= cliente.nombre %>
              </a>
            </td>
            <td><%= cliente.telefono %></td>
            <td><%= cliente.email %></td>
            <td>
              <a href="/clientes/<%= cliente._id %>/editar" class="btn btn-sm btn-primary me-1" title="Editar">
                <i class="bi bi-pencil"></i>
              </a>
              <form action="/clientes/<%= cliente._id %>/eliminar" method="post" style="display:inline;">
                <button class="btn btn-sm btn-danger" onclick="return confirm('¿Eliminar cliente?')" title="Eliminar">
                  <i class="bi bi-trash"></i>
                </button>
              </form>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<!-- Cards en móvil -->
<div class="d-lg-none">
  <div class="row g-3">
    <% clientes.forEach(cliente => { %>
      <div class="col-12">
        <div class="card shadow-sm border-0">
          <div class="card-body">
            <div class="d-flex align-items-center mb-2">
              <i class="bi bi-person-circle me-2 text-primary" style="font-size:2rem;"></i>
              <a href="/clientes/<%= cliente._id %>" class="fw-bold text-dark text-decoration-none enlace-lupa" style="cursor:pointer;">
                <i class="bi bi-search"></i> <%= cliente.nombre %>
              </a>
            </div>
            <div class="mb-2">
              <strong>Teléfono:</strong> <%= cliente.telefono %>
            </div>
            <div class="mb-2">
              <strong>Email:</strong> <%= cliente.email %>
            </div>
            <div class="d-flex gap-2 mt-2">
              <a href="/clientes/<%= cliente._id %>/editar" class="btn btn-sm btn-primary w-100" title="Editar">
                <i class="bi bi-pencil"></i>
              </a>
              <form action="/clientes/<%= cliente._id %>/eliminar" method="post" style="display:inline; width:100%;">
                <button class="btn btn-sm btn-danger w-100" onclick="return confirm('¿Eliminar cliente?')" title="Eliminar">
                  <i class="bi bi-trash"></i>
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>
<%- include('../partials/footer') %>